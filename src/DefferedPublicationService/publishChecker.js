"use strict";const e=require("moment"),t=require("../Models/History"),i=require("../Models/User"),a=require("../Models/News"),s=require("../Models/PublishTime"),d=async()=>{const d=e().startOf("minutes").valueOf(),n=await s.find().where({timestamp:d});if(0!==n.length)n.forEach(async d=>{await s.findByIdAndDelete(d._id);const n=await a.findByIdAndUpdate(d.news_id,{$set:{public_status:"active",date:e().toISOString()}}),r=await i.findById({_id:n.user_id});await new t({type_content:"Новина",operation:"Додавання новини ".concat(n.title),user:r.login}).save()});else{(await a.find().where({public_status:"deffered",date:e().toISOString()})).forEach(async t=>{await a.findByIdAndUpdate(t._id,{public_status:"active",date:e().toISOString()})})}};module.exports={publishChecker:d};