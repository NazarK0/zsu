"use strict";const e=require("express"),r=e.Router(),t=require("../Controllers/auth_controller"),i=require("passport"),{logout:o}=require("../API/ValidatorAuth/validator"),s=require("../API/getAdminid"),l=require("cookie-parser"),n=require("../Models/User");r.get("/login",t.getLoginPage),r.get("/",(e,r)=>{r.redirect("/admin/login")}),r.post("/login",t.login),r.get("/:id_user?/exit",async(e,r)=>{const t=s.getIDfromFullURL(e);await n.findByIdAndUpdate({_id:t},{$set:{session:null,auth_status:!1}}),r.redirect("/admin/login")}),module.exports=r;