"use strict";const e=require("fs"),t=require("path"),i=require("moment"),{Feed:s}=require("feed"),r=require("../Models/News"),{host:o,rssMaxFeeds:a}=require("../../settings.json");module.exports.updateRss=async()=>{const n=t.join(__dirname,"../..","public","rss.xml"),c=await r.find({public_status:"active"}).select({title:1,description:2,publishDate:3,html_body:4}).sort({publishDate:-1}).limit("number"==typeof a?a:5).lean(),l=new s({title:"Офіційний портал ЗСУ",description:"Збройні сили України",link:"https://".concat(o),language:"uk-ua",image:"https://zsu.gov.ua/image/mo.png"});l.addCategory("Новини"),c.forEach(e=>{l.addItem({title:e.title,description:e.description,link:"https://".concat(o,"/content_page/").concat(e._id),date:i(e.publishDate).toDate(),content:e.html_body,id:e._id})});const d=l.rss2();e.writeFile(n,d,e=>{e&&console.error("write rss file error",e)})};