"use strict";const e=require("../../Models/User");module.exports.checkEditPermission=async(i,t,r)=>{const s=await e.findById(i),n=await e.findById(t);return(s.id===n.id||n.id===String(s.creator.id)||"system_user"===n.type)&&(1!==r||(n.id!==i||null))},module.exports.checkNameMatching=async i=>{const t=JSON.parse(JSON.stringify(await e.find()));let r=!1;return t.forEach(e=>{e.login===i&&(r=!0)}),r};