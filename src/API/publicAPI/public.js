"use strict";function e(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function n(n){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?e(Object(i),!0).forEach((function(e){t(n,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e))}))}return n}function t(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}const r=require("../../Models/Content"),i=require("../../Models/Submenu"),a=require("../../Models/ChildSub"),l=require("../../Models/Sidemenu"),o=require("../../Models/MainPhoto"),s=require("../../Models/Corps"),u=require("../../Models/CorpsSign"),d=require("../../Models/CorpsBackground"),c=require("../../Models/Command"),f=require("../../Models/CommandSign"),p=require("../../Models/CommandBackground"),b=require("../../Models/SliderNames"),y=require("path"),O=require("fs");async function g(e,n){let t=null,r=null;if(null===e&&null===n)return{front_url:null,back_url:null};const i=await JSON.parse(JSON.stringify(await u.findById(e))),a=await JSON.parse(JSON.stringify(await d.findById(n)));return null!==i&&void 0!==i.url&&(t=i.base64),null!==a&&void 0!==a.url&&(r=a.base64),{front_base64:t,back_base64:r}}async function _(e,n){let t=null,r=null;if(null===e&&null===n)return{front_url:null,back_url:null};const i=await JSON.parse(JSON.stringify(await f.findById(e))),a=await JSON.parse(JSON.stringify(await p.findById(n)));return null!==i&&void 0!==i.url&&(t=i.base64),null!==a&&void 0!==a.url&&(r=a.base64),{front_base64:t,back_base64:r}}async function m(e,n){const t=await o.findOne().where({base_url:e});if(null!==t&&void 0!==t.name){const n=y.join(__dirname,"../../../","uploads",e,"fullsize",t.name),r=y.join(__dirname,"../../../","uploads",e,"middlesize",t.name),i=y.join(__dirname,"../../../","uploads",e,"smallsize",t.name);return{small:O.readFileSync(i,"base64"),middle:O.readFileSync(r,"base64"),full:O.readFileSync(n,"base64")}}return null}module.exports.getOneElementBody=async e=>{const t=JSON.parse(JSON.stringify(await i.findById(e))),l=JSON.parse(JSON.stringify(await a.findById(e)));if(Boolean(t)){let e=n({},t);const i=await r.findById(t.content_id);return e.content=i,e}if(Boolean(l)){let e=n({},t);const i=await r.findById(l.content_id);return e.content=i,e}return null},module.exports.getSideMenu=async()=>{const e=JSON.parse(JSON.stringify(await l.find())),t=[];for(let i=0;i<e.length;i++){let a=n({},e[i]);null!==e[i].content_id&&(a.content=await r.findById(e[i].content_id),a.photo=await m(a.content.content_baseUrl),t.push(a))}return t},module.exports.getNews=async()=>{const e=[],t=JSON.parse(JSON.stringify(await r.find().where({page_type:"news"})));for(let r=0;r<t.length;r++){let i=n({},t[r]);i.photo=await m(t[r].content_baseUrl),e.push(i)}return e},module.exports.getResultForTroops=async()=>{let e=[],n=JSON.parse(JSON.stringify(await s.find()));for(let t=0;t<n.length;t++){const r=await g(n[t].sign_id,n[t].bg_id);let i={title:n[t].title,link:n[t].link,front_photo:r.front_base64,back_photo:r.back_base64};e.push(i)}return e},module.exports.getResultForCommand=async()=>{let e=[],n=JSON.parse(JSON.stringify(await c.find()));for(let t=0;t<n.length;t++){const r=await _(n[t].sign_id,n[t].bg_id);let i={title:n[t].title,link:n[t].link,front_photo:r.front_base64,back_photo:r.back_base64};e.push(i)}return e},module.exports.getSlidersPhotoPath=async(e,n)=>{const t=[],i=[];if(2==n)var a=await r.findOne().where({generated_sidemenu_link:e.params.id});else a=await r.findById(e.params.id);const l=JSON.parse(JSON.stringify(await b.findOne().where({base_url:a.content_baseUrl})));if(l){const{names:e,base_url:n}=l;for(let r=0;r<e.length;r++)t.push(n+"sliders/"+e[r]);for(let r=0;r<t.length;r++){const e=y.join(__dirname,"../../../","uploads",t[r]);i.push(O.readFileSync(e,"base64"))}return i}return null};