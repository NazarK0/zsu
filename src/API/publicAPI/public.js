"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t(t){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?e(Object(i),!0).forEach((function(e){n(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const r=require("../../Models/Content"),i=require("../../Models/Submenu"),l=require("../../Models/ChildSub"),a=require("../../Models/Sidemenu"),o=require("../../Models/MainPhoto"),s=require("../../Models/Corps"),u=require("../../Models/CorpsSign"),d=require("../../Models/CorpsBackground"),c=require("../../Models/SliderNames"),f=require("path"),p=require("fs");async function y(e,t){if(front_result=null,back_result=null,null===e&&null===t)return{front_url:null,back_url:null};const n=await JSON.parse(JSON.stringify(await u.findById(e))),r=await JSON.parse(JSON.stringify(await d.findById(t)));return null!==n&&void 0!==n.url&&(front_result=p.readFileSync(n.url,"base64")),null!==r&&void 0!==r.url&&(back_result=p.readFileSync(r.url,"base64")),{front_url:front_result,back_url:back_result}}async function b(e,t){const n=await o.findOne().where({base_url:e});if(null!==n&&void 0!==n.name){const t=f.join(__dirname,"../../../","uploads",e,"fullsize",n.name),r=f.join(__dirname,"../../../","uploads",e,"middlesize",n.name),i=f.join(__dirname,"../../../","uploads",e,"smallsize",n.name);return{small:p.readFileSync(i,"base64"),middle:p.readFileSync(r,"base64"),full:p.readFileSync(t,"base64")}}return null}module.exports.getOneElementBody=async e=>{const n=JSON.parse(JSON.stringify(await i.findById(e))),a=JSON.parse(JSON.stringify(await l.findById(e)));if(Boolean(n)){let e=t({},n);const i=await r.findById(n.content_id);return e.content=i,e}if(Boolean(a)){let e=t({},n);const i=await r.findById(a.content_id);return e.content=i,e}return null},module.exports.getSideMenu=async()=>{const e=JSON.parse(JSON.stringify(await a.find())),n=[];for(let i=0;i<e.length;i++){let l=t({},e[i]);null!==e[i].content_id&&(l.content=await r.findById(e[i].content_id),l.photo=await b(l.content.content_baseUrl),n.push(l))}return n},module.exports.getNews=async()=>{const e=[],n=JSON.parse(JSON.stringify(await r.find().where({page_type:"news"})));for(let r=0;r<n.length;r++){let i=t({},n[r]);i.photo=await b(n[r].content_baseUrl),e.push(i)}return e},module.exports.getResultForTroops=async()=>{let e=[],t=JSON.parse(JSON.stringify(await s.find()));for(let n=0;n<t.length;n++){const r=await y(t[n].sign_id,t[n].bg_id);let i={title:t[n].title,link:t[n].link,front_photo:r.front_url,back_photo:r.back_url};e.push(i)}return e},module.exports.getSlidersPhotoPath=async(e,t)=>{const n=[],i=[];if(2==t)var l=await r.findOne().where({generated_sidemenu_link:e.params.id});else l=await r.findById(e.params.id);const a=JSON.parse(JSON.stringify(await c.findOne().where({base_url:l.content_baseUrl}))),{names:o,base_url:s}=a;for(let r=0;r<o.length;r++)n.push(s+"sliders/"+o[r]);for(let r=0;r<n.length;r++){const e=f.join(__dirname,"../../../","uploads",n[r]);i.push(p.readFileSync(e,"base64"))}return i};