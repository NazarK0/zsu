"use strict";const s=require("uniqid"),i=require("../../Models/User"),e=require("moment"),n=e();function t(s){return e().isBefore(s)}async function d(s){await i.findByIdAndUpdate(s,{session:null,auth_status:!1})}module.exports.CreateSession=async(t,d)=>{t.id_user=d,t.id_session=s.time(),t.valid_time=e(n,"DD-MM-YY").add(6,"hour"),await i.findByIdAndUpdate(d,{session:{id_session:t.id_session,valid_time:t.valid_time,auth_status:!0}})},module.exports.ValidSession=async(s,e,n)=>{const a=JSON.parse(JSON.stringify(await i.findById(e)));if(null===a.session)return null;const u=null!==a?a.session.valid_time:null;return!0!==a.session.auth_status?null:a.session.id_session===s.id_session?!0===t(u)||(await d(a.id),null):!0!==t(u)&&(!1===t(u)?(await d(a.id),null):void 0)};