"use strict";const s=require("uniqid"),i=require("../../Models/User"),n=require("moment"),{session:e}=require("passport"),o=n();async function t(e,o){e.id_user=o,e.id_session=s.time(),e.valid_time=n().add(2,"hours"),await i.findByIdAndUpdate(o,{session:{id_session:e.id_session,valid_time:e.valid_time,auth_status:!0}})}async function d(s,n,e){const o=JSON.parse(JSON.stringify(await i.findById(n)));if(null===o.session)return null;const t=null!==o?o.session.valid_time:null;return!0!==o.session.auth_status?null:o.session.id_session===s.id_session?!0===a(t)||(await l(o.id),null):!0!==a(t)&&(!1===a(t)?(await l(o.id),null):void 0)}function a(s){let i=n().isBefore(s);return console.log(i),i}async function l(s){console.log("in"),await i.findByIdAndUpdate(s,{session:null})}module.exports={ValidSession:d,CreateSession:t,DropSessionForUser:l};