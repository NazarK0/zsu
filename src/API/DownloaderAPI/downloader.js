"use strict";const e=require("json2xls"),{Parser:s}=require("json2csv"),r=require("fs"),t=require("path"),i=require("../../Models/History"),a=require("../../Models/Content"),n=require("../../Models/User"),o=require("../../Models/MessageArchive"),{MESSAGE:c}=require("../op_categories");async function l(e){let s;switch(e){case 1:return s=JSON.parse(JSON.stringify(await i.find().select({user:1,type_content:2,operation:3,create_date:4,_id:0}))),{json:s,name_file:"history"};case 2:return s=JSON.parse(JSON.stringify(await a.find().where({page_type:"news"}).select({page_title:1,news_type:2,lang:3,date:4,_id:0}))),{json:s,name_file:"news"};case 3:return s=JSON.parse(JSON.stringify(await n.find().select({login:2,operation:3,email:4,creator:5,_id:1}))),{json:s,name_file:"users"};case 4:return s=JSON.parse(JSON.stringify(await o.find().select({email:1,text:2,date:3,login_response:4,text_response:5,date_response:6}))),{name_file:"message_archive",json:s}}}module.exports.getJSON=async e=>await l(e);