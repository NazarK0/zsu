"use strict";const e=require("../../Models/Content"),t=require("../../Models/Submenu"),n=require("../../Models/ChildSub"),i=require("../../Models/Sidemenu");async function s(e){const i=await t.findById(e),s=await n.findById(e);return i?{type:"Так",title:i.title}:s?{type:"Так",title:s.title}:{type:"Ні",title:"Відсутня"}}async function l(e){const t=await i.findById(e);return null!==t?{type:"Так",title:t.title}:{type:"Ні",title:"Відсутня"}}function a(e,t,n){const i={...e};return!0===n?(i.dependense_main=t.type,i.dependense_main_title=t.title,i):!1===n?(i.dependense_side=t.type,i.dependense_side_title=t.title,i):void 0}module.exports.getCanceledPage=async t=>{const n=[];let i={page_type:"content_page",$or:[{public_status:"cancel"},{public_status:"deffered"}]};if(t.length){const n=t.filter(e=>"historyWar"!==e&&"current"!==e&&"files"!==e&&"contacts"!==e);if(t.includes("historyWar")){const t=await e.find({page_subclass:"historyWar"}).select({_id:1}).lean();n.push(...t.map(e=>e._id))}if(t.includes("current")){const t=await e.find({page_subclass:"current"}).select({_id:1}).lean();n.push(...t.map(e=>e._id))}if(t.includes("files")){const t=await e.find({page_subclass:"files"}).select({_id:1}).lean();n.push(...t.map(e=>e._id))}if(t.includes("contacts")){const t=await e.find({page_subclass:"contacts"}).select({_id:1}).lean();n.push(...t.map(e=>e._id))}if(t.includes("casual")){const t=await e.find({page_subclass:"casual"}).select({_id:1}).lean();n.push(...t.map(e=>e._id))}i={...{...i},_id:{$in:n}}}const c=await e.find(i).select({_id:1,page_title:2,generated_menu_link:3,generated_sidemenu_link:4,lang:5,keywords:6}).lean();for(let e=0;e<c.length;e++){const{generated_menu_link:t,generated_sidemenu_link:i}=c[e];if(null!==t){const n=await s(t);c[e]=a(c[e],n,!0)}if(null!==i){const t=await l(i);null!==t&&(c[e]=a(c[e],t,!1)),null===t&&(c[e]=a(c[e],{type:"Ні",title:"Відсутня"},!1))}null===t&&(c[e]=a(c[e],{type:"Ні",title:"Відсутня"},!0)),null===i&&(c[e]=a(c[e],{type:"Ні",title:"Відсутня"},!1)),n.push(c[e])}return n},module.exports.getAllPage=async t=>{const n=[];let i={page_type:"content_page",public_status:"active"};if(t.length){const n=t.filter(e=>"historyWar"!==e&&"current"!==e&&"files"!==e&&"contacts"!==e);if(t.includes("historyWar")){const t=await e.find({page_subclass:"historyWar"}).select({_id:1}).lean();n.push(...t.map(e=>e._id))}if(t.includes("current")){const t=await e.find({page_subclass:"current"}).select({_id:1}).lean();n.push(...t.map(e=>e._id))}if(t.includes("files")){const t=await e.find({page_subclass:"files"}).select({_id:1}).lean();n.push(...t.map(e=>e._id))}if(t.includes("contacts")){const t=await e.find({page_subclass:"contacts"}).select({_id:1}).lean();n.push(...t.map(e=>e._id))}if(t.includes("casual")){const t=await e.find({page_subclass:"casual"}).select({_id:1}).lean();n.push(...t.map(e=>e._id))}i={...{...i},_id:{$in:n}}}const c=await e.find(i).select({_id:1,page_title:2,generated_menu_link:3,generated_sidemenu_link:4,page_subclass:5,lang:6,keywords:7}).lean();for(let e=0;e<c.length;e++){const{generated_menu_link:t,generated_sidemenu_link:i}=c[e];if(null!==t){const n=await s(t);c[e]=a(c[e],n,!0)}if(null!==i){const t=await l(i);null!==t&&(c[e]=a(c[e],t,!1)),null===t&&(c[e]=a(c[e],{type:"Ні",title:"Відсутня"},!1))}null===t&&(c[e]=a(c[e],{type:"Ні",title:"Відсутня"},!0)),null===i&&(c[e]=a(c[e],{type:"Ні",title:"Відсутня"},!1)),n.push(c[e])}return n};