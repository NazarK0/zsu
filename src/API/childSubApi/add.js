"use strict";const n=require("../../Models/Content"),e=require("../../Models/ChildSub"),t=require("../../Models/Submenu");module.exports.addSubChild=async(l,i)=>{try{const{title:d,lang:u,content_id:a,link_id:o}=l.body,{submenu_id:c}=l.params;let r,s=(await e.find().where({parent_sub:c}).lean()).length;"null"!==a&&"unlink"!==a&&a?(await t.findOneAndUpdate({content_id:a},{content_id:null}),await e.findOneAndUpdate({content_id:a},{content_id:null}),r=new e({title:d,lang:u,parent_sub:c,child:[],content:null,content_id:a,number:s+1,user_id:i})):r=new e({title:d,lang:u,parent_sub:c,child:[],content:null,content_id:null,link:"null"!==o?o:null,number:s+1,user_id:i}),await r.save(),r.content_id&&await n.findByIdAndUpdate(a,{generated_menu_link:r.id})}catch(d){console.log(d)}};